<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script> -->
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>



                      <section>
                        <div class="container mt-4">
                            <div class="row">
                                <div class="col-md-6">
                                    <h2 class="text-center">Edit Product</h2>
                                    <form action="/admin/edit/<%=editProduct._id %>?_method=PUT" id="editProductForm" method="post" enctype="multipart/form-data">
                                        
                                        <label for="">productName</label>
                                        <input type="text" name="productName" class="form-control" value="<%=editProduct.productName %>" required>
                    
                                        <label for="">productPrice</label>
                                        <input type="text" name="productPrice"" class="form-control" value="<%=editProduct.productPrice %>">
                    
                                        <label for="">salePrice</label>
                                        <input type="text" name="salePrice" class="form-control" value="<%=editProduct.salePrice %>">
                    
                                        <label for="">category</label>
                                        <input type="text" name="category" class="form-control" value="<%=editProduct.category %>">
                                       
                                        <label for="">stock</label>
                                        <input type="text" name="stock" class="form-control" value="<%=editProduct.stock %>">
                    
                    
                                        <label for="">Image</label>
                                        <% editProduct.images.forEach(image => { %>
                                            <td>
                                              <img style="width:100px; height: auto;" src="/product-images/<%=image%>" alt="Product Image" id="imgView">
                                            </td>
                                        <% }) %>
                                        <input type="file" name="Image" class="form-control" onchange="viewImage(event)" multiple>
                                        
                    
                                        <button type="submit" class="btn btn-success mt-4">Submit</button>
                    
                                        
                                    </form>
                                </div>
                            </div>
                        </div>
                    </section> 
                 



<script>
    function viewImage(event) {
         const images = document.querySelectorAll('img[id^="imgView"]');
         Array.prototype.forEach.call(images, (img, index) => {
         img.src = URL.createObjectURL(event.target.files[index]);
  });
}


      
    $(document).ready(function () {
      $.validator.addMethod(
        "noSpecialChars",
        function (value, element) {
          return this.optional(element) || /^(?!\s)[a-zA-Z ]+$/.test(value);
        },
        "Special characters and spaces are not allowed"
      );
      $("#addProductForm").validate({
        rules: {
         
          productName: {
            required: true,
            minlength: 3,
         
          },
          productPrice: {
            required: true,
            minlength: 3,
            
          },
          salePrice:{
            required: true,
          },
          category:{
            required: true,
    
          },
          stock:{
             required: true,
          },
          Image: {
            required: true,
          },
          Image: {
            required: true,
          },
          Image: {
            required: true,
          },
        },
        messages: {
         
          productName: {
            required: "Please enter product name",
            minlength: "It must be at least 3 characters long",
            noSpecialChars: "Special characters and spaces are not allowed",
          },
           
          category: {
            required: "Please enter category name",
            minlength: "It must be at least 3 characters long",
            noSpecialChars: "Special characters and spaces are not allowed",
          },
           
          productPrice: {
            required: "Please enter price",
            noSpecialChars: "Special characters and spaces are not allowed",
          },
          salePrice: {
            required: "Please enter price",
            noSpecialChars: "Special characters and spaces are not allowed",
          },
          stock: {
            required: "Please enter stock ",
            minlength: "It must be at least 3 characters long",
            noSpecialChars: "Special characters and spaces are not allowed",
          },
           
          Image: {
            required: "Please upload a product image",
          },
        },
        highlight: function (element) {
          $(element).closest(".form-control").addClass("is-invalid");
        },
        unhighlight: function (element) {
          $(element).closest(".form-control").removeClass("is-invalid");
        },
        errorElement: "div",
        errorClass: "invalid-feedback",
        errorPlacement: function (error, element) {
          if (element.parent(".input-group").length) {
            error.insertAfter(element.parent());
          } else {
            error.insertAfter(element);
          }
        },
      });
    });
  </script>